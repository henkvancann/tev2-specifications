"use strict";(self.webpackChunktev2_specifications=self.webpackChunktev2_specifications||[]).push([[5720],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=p(n),h=a,u=d["".concat(l,".").concat(h)]||d[h]||c[h]||o;return n?r.createElement(u,i(i({ref:t},m),{},{components:n})):r.createElement(u,i({ref:t},m))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9187:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=n(3117),a=(n(7294),n(3905));const o={},i="Deployment",s={unversionedId:"spec-tools/tool-docs/trrt/deployment",id:"spec-tools/tool-docs/trrt/deployment",title:"Deployment",description:"TRRT Example",source:"@site/docs/spec-tools/tool-docs/trrt/4-deployment.md",sourceDirName:"spec-tools/tool-docs/trrt",slug:"/spec-tools/tool-docs/trrt/deployment",permalink:"/tev2-specifications/docs/spec-tools/tool-docs/trrt/deployment",draft:!1,editUrl:"https://github.com/tno-terminology-design/tev2-specifications/blob/master/docs/spec-tools/tool-docs/trrt/4-deployment.md",tags:[],version:"current",lastUpdatedBy:"Ca5e",lastUpdatedAt:1700853879,formattedLastUpdatedAt:"Nov 24, 2023",sidebarPosition:4,frontMatter:{},sidebar:"tev2SideBar",previous:{title:"Customization",permalink:"/tev2-specifications/docs/spec-tools/tool-docs/trrt/customization"},next:{title:"Error Reporting",permalink:"/tev2-specifications/docs/spec-tools/tool-docs/trrt/error-reporting"}},l={},p=[{value:"TRRT Example",id:"trrt-example",level:2},{value:"Example Deployment Case",id:"example-deployment-case",level:2},{value:"Executed Steps",id:"executed-steps",level:3}],m={toc:p};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"deployment"},"Deployment"),(0,a.kt)("h2",{id:"trrt-example"},"TRRT Example"),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," is designed to be usable in both a command-line interface and a CI/CD pipeline. Features like the ",(0,a.kt)("a",{parentName:"p",href:"usage#configuration-file"},"configuration file"),", make the execution of the tool easily maintainable, and ",(0,a.kt)("a",{parentName:"p",href:"error-reporting"},"error reporting")," is available to assist further in the resolution of terms."),(0,a.kt)("p",null,"The GitHub repository of the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT"),", located ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/tno-terminology-design/trrt"},"here")," acts as an example of the tool's deployment. Within the ",(0,a.kt)("inlineCode",{parentName:"p"},".github/workflows/docs-deploy.yml")," GitHub Actions Workflow file are the following lines of code. This code is located in the deploy job before the website is built, modifying the input files in runtime before they are used to build the Docusaurus site."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yml"},"  # Terminology reference resolution\n- name: Install TRRT\n  run: npm install -g @tno-terminology-design/trrt@1.x\n- name: Run TRRT\n  run: trrt --output . --scopedir __tests__/content '**/*.md' --force\n")),(0,a.kt)("p",null,"This execution of the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," is run from the root of the repository, any input files that contain successfully converted ",(0,a.kt)("a",{parentName:"p",href:"@"},"term refs")," will be output starting from that location as well. The ",(0,a.kt)("a",{parentName:"p",href:"@"},"scope directory")," is set to ",(0,a.kt)("inlineCode",{parentName:"p"},"__tests__/content"),", as this is where the SAF resides. Every file that matches the ",(0,a.kt)("inlineCode",{parentName:"p"},"'**/*.md'")," glob pattern string is given to the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT"),", in this case meaning every file in every directory ending with ",(0,a.kt)("inlineCode",{parentName:"p"},".md")," is seen as input.\nAs the output directory is the same as the current directory, converted files will overwrite the existing files when we use the ",(0,a.kt)("inlineCode",{parentName:"p"},"force")," flag. This forceful behavior is useful for deployment inside pipelines where the original files are usually not modified, but should be avoided during local use in order to preserve the original documents that include ",(0,a.kt)("a",{parentName:"p",href:"@"},"term refs"),"."),(0,a.kt)("h2",{id:"example-deployment-case"},"Example Deployment Case"),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," needs one ",(0,a.kt)("a",{parentName:"p",href:"@"},"SAF")," and one or more ",(0,a.kt)("a",{parentName:"p",href:"@"},"MRG's")," in order to function and will check to make sure the required properties within these files are set. Not being able to load a ",(0,a.kt)("a",{parentName:"p",href:"@"},"SAF")," will cause the program to exit. Not being able to load a complete ",(0,a.kt)("a",{parentName:"p",href:"@"},"MRG"),", or finding an invalid entry within an ",(0,a.kt)("a",{parentName:"p",href:"@"},"MRG"),", will not cause the program to be stopped, but will be displayed as a ",(0,a.kt)("inlineCode",{parentName:"p"},"MRG HELP")," item (see ",(0,a.kt)("a",{parentName:"p",href:"error-reporting"},"Error Reporting"),")."),(0,a.kt)("p",null,"To demonstrate the tool's possibilities, lets imagine the following scenario.\nYou are part of a community that wishes to curate their terminologies. You have read up on the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TNO Terminology Design")," specifications and have constructed a ",(0,a.kt)("a",{parentName:"p",href:"@"},"SAF")," to fit your needs. The ",(0,a.kt)("a",{parentName:"p",href:"@"},"SAF")," includes information about the scopes you and your colleagues would want to be able to reference. Inside the written texts of your community, the ",(0,a.kt)("a",{parentName:"p",href:"specifications#interpretation-of-the-term-ref"},"basic term ref syntax")," has been used to reference terms. All of the used terms are located in an ",(0,a.kt)("a",{parentName:"p",href:"@"},"MRG"),", which is located in the ",(0,a.kt)("inlineCode",{parentName:"p"},"glossarydir")," as defined in the ",(0,a.kt)("a",{parentName:"p",href:"@"},"SAF"),".\nThe standard converters of the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," do not fit the needs of your community. Your colleagues have already set up a website to display the files and have done some work to streamline existing terms using a custom JavaScript element. The custom element they made looks like this while being used inline:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<term-info\n    definition="A\xa0mishmash\xa0is a confused mess of different things."\n    img="img/mismash.png"\n    more-info="docs/terms/mishmash.html">mishmash\n</term-info>\n')),(0,a.kt)("p",null,"Assuming the term 'mishmash' is part of an ",(0,a.kt)("a",{parentName:"p",href:"@"},"MRG"),", and the default scope and version tag have been set, mishmash can be referenced by using the syntax ",(0,a.kt)("inlineCode",{parentName:"p"},"[mishmash](@)"),". Running the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," with the following config example should achieve the wanted results. ",(0,a.kt)("em",{parentName:"p"},"Pay special attention to the converter.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="__tests__/content/config.yaml"',title:'"__tests__/content/config.yaml"'},"# TRRT configuration file (yaml)\noutput: .\nscopedir: .\ninterpreter: 'basic' # `alt` or `basic` are also valid\n# highlight-next-line\nconverter: '<term-info definition=\"{{glossaryText}}\" img=\"img/{{term}}.png\" more-info=\"{{navurl}}\">{{showtext}}</term-info>' # `http`, `essif` or `markdown` are also valid\n\n# glob pattern strings for files to be processed\ninput:\n\xa0 - '**/*.md'\n")),(0,a.kt)("p",null,"As the ",(0,a.kt)("inlineCode",{parentName:"p"},"output")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"scopedir")," arguments are the same, it might be necessary to call the tool with the ",(0,a.kt)("inlineCode",{parentName:"p"},"force")," ",(0,a.kt)("a",{parentName:"p",href:"specifications#calling-the-tool"},"flag")," in order to overwrite the existing files. While testing, it may be more useful to supply a separate ",(0,a.kt)("inlineCode",{parentName:"p"},"output")," directory and not use the ",(0,a.kt)("inlineCode",{parentName:"p"},"force")," flag."),(0,a.kt)("h3",{id:"executed-steps"},"Executed Steps"),(0,a.kt)("p",null,"The following steps have been executed to reach a working implementation of the tool based on the ",(0,a.kt)("a",{parentName:"p",href:"#example-deployment"},"example deployment")," above. Multiple approaches are possible, like using ",(0,a.kt)("inlineCode",{parentName:"p"},"wget")," instead of ",(0,a.kt)("inlineCode",{parentName:"p"},"curl"),", or ",(0,a.kt)("inlineCode",{parentName:"p"},"yarn")," instead of ",(0,a.kt)("inlineCode",{parentName:"p"},"npm"),", but these have not been documented."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Make sure the ",(0,a.kt)("a",{parentName:"strong",href:"installation#prerequisites"},"prerequisites")," are met.")," ",(0,a.kt)("br",null),"\nPlease refer to ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/nvm-sh/nvm"},"nvm's")," installation and usage for the latest details about these commands. This step will likely not be necessary if you are integrating the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," inside a pipeline."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'# Download and install nvm\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.4/install.sh | bash\n# Download and install node.js\nnvm install node # "node" is an alias for the latest version\nnvm use node # Use the installed node.js version\n'))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Install the latest version of the ",(0,a.kt)("a",{parentName:"strong",href:"@"},"TRRT")," and its dependencies globally.")," ",(0,a.kt)("br",null),"\nThis makes the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," CLI command available all throughout your system and does not initialize the current working directory with ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com"},"npm")," files."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npm install -g @tno-terminology-design/trrt\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Configure the ",(0,a.kt)("a",{parentName:"strong",href:"@"},"SAF")," and make sure the necessary ",(0,a.kt)("a",{parentName:"strong",href:"@"},"MRG"),"'s are present.")," ",(0,a.kt)("br",null),"\nOur example deployment ",(0,a.kt)("inlineCode",{parentName:"p"},"saf.yaml")," can be viewed ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/tno-terminology-design/trrt/blob/main/__tests__/content/saf.yaml"},"here")," within the ",(0,a.kt)("inlineCode",{parentName:"p"},"__tests__/content")," directory, with the ",(0,a.kt)("a",{parentName:"p",href:"@"},"MRG's")," located in the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/tno-terminology-design/trrt/tree/main/__tests__/content/terminology"},"glossarydir")," at ",(0,a.kt)("inlineCode",{parentName:"p"},"__tests__/content/terminology"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Setup the ",(0,a.kt)("a",{parentName:"strong",href:"@"},"TRRT")," behavior per ",(0,a.kt)("a",{parentName:"strong",href:"usage#configuration-file"},"configuration file")," and/or command-line parameters.")," ",(0,a.kt)("br",null),"\nSee the ",(0,a.kt)("a",{parentName:"p",href:"#example-deployment"},"example deployment")," above for the yaml configuration file that is used. In this case we will be executing the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," from the root of our repository and not the root of the ",(0,a.kt)("a",{parentName:"p",href:"@"},"scopedir"),". Make sure to confirm your working directory and adjust any of the path related parameters before continuing to step 5.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Execute the ",(0,a.kt)("a",{parentName:"strong",href:"@"},"TRRT"),".")," ",(0,a.kt)("br",null),"\nWe will use the following command to run the tool according to the ",(0,a.kt)("inlineCode",{parentName:"p"},"__tests__/content/config.yaml")," config file. As the ",(0,a.kt)("a",{parentName:"p",href:"#example-deployment"},"example deployment")," is executed within a CI/CD pipeline we will be using the ",(0,a.kt)("inlineCode",{parentName:"p"},"force")," flag to overwrite the input files with their renderable counterparts. The configured paths are relative to the working directory where the ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," is executed."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"trrt --config __tests__/content/config.yaml --force\n"))),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"Verify successful execution.")," ",(0,a.kt)("br",null),"\nThe ",(0,a.kt)("a",{parentName:"p",href:"@"},"TRRT")," CLI outputs information about its execution to the console according to the ",(0,a.kt)("a",{parentName:"p",href:"error-reporting"},"Error Reporting")," messages. The output should provide enough information to resolve issues surrounding the execution of the tool and the related terminology design."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-n/a",metastring:'title="Sample console output"',title:'"Sample',console:!0,'output"':!0},"INFO    Converter.js    Using essif template: '<a href=\"{{navurl}}{{#trait}}#{{/trait}}{{trait}}\" title=\"{{capFirst term}}: {{noRefs glossaryText type=\"markdown\"}}\">{{showtext}}</a>'\nINFO    Interpreter.js  Using basic interpreter: '/(?:(?<=[^`\\\\])|^)\\[(?=[^@\\]]+\\]\\([#a-z0-9_-]*@[:a-z0-9_-]*\\))(?<showtext>[^\\n\\]@]+)\\]\\((?:(?<id>[a-z0-9_-]*)?(?:#(?<trait>[a-z0-9_-]+))?)?@(?<scopetag>[a-z0-9_-]*)(?::(?<vsntag>[a-z0-9_-]+))?\\)/g'\nINFO    Resolver.js     Reading files using pattern string '**/*.md'\nINFO    Resolver.js     Found 111 files\nINFO    Run.js          Resolution complete...\n\nResolution Report:\n      Number of files modified: 110\n      Number of terms converted: 3224\n  Term Errors:\nTERM HELP    Term ref '[frontmatter](@)' > 'frontmatter@tev2:terms', could not be matched with an MRG entry:\n docs/terms/term-identifier.md:8\nTERM HELP    Term ref '[owner](@)' > 'owner@tev2:terms', could not be matched with an MRG entry:\n docs/terms/scope.md:7:7\n docs/terms/knowledge-artifact.md:29\n")))))}c.isMDXComponent=!0}}]);